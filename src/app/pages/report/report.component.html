<div *ngIf="!(loading | async); else loadingIcon">
  <div class="ml-4 mr-5 header">
    <h2 class="d-inline-block header-title">Total</h2>
  </div>

  <div>
    <div class="ml-4 mr-5 mt-3 header">
      <form [formGroup]="form">
        <div class="d-inline-block ml-2">
          <p class="d-inline-block header-title">Title</p>
          <div class="d-inline-block ml-2" >
            <input id="titleMask" type="text" name="titleMask" class="form-control" formControlName="title" (change)="handleChanges()">
          </div>
        </div>

        <div class="d-inline-block ml-2">
          <p class="d-inline-block header-title">Date</p>
          <div class="d-inline-block ml-2" >
            <input id="dateMask" type="date" name="dateMask" class="form-control" formControlName="date" (change)="handleChanges()">
          </div>
        </div>
     </form>

    </div>

    <div *ngIf="(histories | async).length != 0; else noDataBlock">
      <table class="table table-hover mt-2">
        <thead>
        <tr>
          <ng-container *ngFor='let column of columns'>
            <th (click)='handleSortChange(column)'>
              {{ column.title }}
              <i *ngIf='column.name === sortRule?.columnName'
                 class="fa {{sortRule.direction === sortDirections.Decrease ? 'fa-arrow-down' : 'fa-arrow-up'}}" >
              </i>
            </th>
          </ng-container>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let record of (histories | async)">
          <ng-container *ngFor='let column of columns'>
            <ng-container [ngSwitch]='column.formatter'>
              <td *ngSwitchCase='"date"'>{{ record[column.name] | date : column.extraForFormatter }}</td>
              <td *ngSwitchDefault>{{ record[column.name] }}</td>
            </ng-container>
          </ng-container>
        </tr>
        </tbody>
      </table>

      <app-pagination-block [currentPage]="currentPage"
                            [amountPages]="amountPages"
                            (selectedPage)="setPage($event)">
      </app-pagination-block>
    </div>
  </div>
</div>

<ng-template #loadingIcon>
  <app-spinner></app-spinner>
</ng-template>

<ng-template #noDataBlock>
  <app-no-data-block></app-no-data-block>
</ng-template>
